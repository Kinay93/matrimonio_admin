<div id="navbar-container">
  <header>
    <button id="menuBtn" class="toggle-btn">☰</button>
    <h1 id="pageTitle">Amministrazione</h1>

    <div class="user-menu">
      <button id="userBtn" class="user-btn">
        <img src="https://img.icons8.com/ios-filled/50/user-male-circle.png" alt="Avatar">
        <span id="usernameDisplay">Admin</span>
      </button>
      <div id="dropdownMenu" class="dropdown-menu">
        <a href="#" id="profiloLink">Profilo</a>
        <a href="temaadmin.html">Temi</a>
        <a href="#" onclick="logout()">Logout</a>
      </div>
    </div>
  </header>

  <nav id="sideNavbar" class="sidebar">
    <span class="closebtn" onclick="closeSidebar()">×</span>
    <a href="index.html">Home</a>
    <a href="marketplace.html">Marketplace</a>
    <a href="coppie.html">Coppie</a>
  </nav>
</div>

<script>
  // Dropdown toggle
  const userBtn = document.getElementById('userBtn');
  const dropdownMenu = document.getElementById('dropdownMenu');
  userBtn.addEventListener('click', () => {
    dropdownMenu.style.display = dropdownMenu.style.display === 'block' ? 'none' : 'block';
  });
  // Chiudi dropdown se clic fuori
  window.addEventListener('click', e => {
    if (!userBtn.contains(e.target)) dropdownMenu.style.display = 'none';
  });

  // Sidebar toggle
  const sideNavbar = document.getElementById('sideNavbar');
  document.getElementById('menuBtn').addEventListener('click', () => {
    sideNavbar.style.width = sideNavbar.style.width === '250px' ? '0' : '250px';
  });
  function closeSidebar() { sideNavbar.style.width = '0'; }

  // Inserimento username loggato
  const urlParams = new URLSearchParams(window.location.search);
  const usernameAdmin = urlParams.get('username') || localStorage.getItem('admin_username') || 'Admin';
  document.getElementById('usernameDisplay').textContent = usernameAdmin;
  document.getElementById('profiloLink').href = `profilo.html?username=${usernameAdmin}`;

  // Logout
  function logout() {
    localStorage.removeItem('auth_token');
    localStorage.removeItem('admin_username');
    window.location.href = 'login.html';
  }
</script>
