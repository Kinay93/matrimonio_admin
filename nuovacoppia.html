<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <title>Nuova Coppia</title>
</head>
<body>
    <div class="container">
        <h1>Nuovo Matrimonio</h1>

        <label for="nomeCoppia">Nome della Coppia:</label>
        <input type="text" id="nomeCoppia" placeholder="Inserisci nome coppia">

        <label for="fotoCoppia">Foto della coppia:</label>
        <input type="file" id="fotoCoppia">

        <label for="colorSfondo">Colore sfondo:</label>
        <input type="color" id="colorSfondo" value="#ffffff">

        <label for="colorTesto">Colore testo:</label>
        <input type="color" id="colorTesto" value="#000000">

        <button id="creaCoppiaBtn">Crea coppia</button>

        <div id="msg"></div>
    </div>

    <script>
        document.getElementById("creaCoppiaBtn").addEventListener("click", async () => {
            const nome = document.getElementById("nomeCoppia").value.trim();
            const fotoFile = document.getElementById("fotoCoppia").files[0];
            const colorSfondo = document.getElementById("colorSfondo").value;
            const colorTesto = document.getElementById("colorTesto").value;

            if (!nome) { alert("Inserisci un nome per la coppia"); return; }
            if (!fotoFile) { alert("Seleziona una foto della coppia"); return; }

            const formData = new FormData();
            formData.append("nome_coppia", nome);
            formData.append("foto_coppia", fotoFile);
            formData.append("style_css_colore_sfondo", colorSfondo);
            formData.append("style_css_colore_testo", colorTesto);

            const res = await fetch('https://matrimonioapp.ew.r.appspot.com/admin/crea_coppia', {
                method: "POST",
                body: formData
            });

            const data = await res.json();
            if (data.success) {
                document.getElementById("msg").innerText = "Coppia creata con successo!";
                setTimeout(() => { window.location.href = "index.html"; }, 1000);
            } else {
                document.getElementById("msg").innerText = "Errore: " + (data.error || "Imprevisto");
            }
        });
    </script>
</body>
</html>
